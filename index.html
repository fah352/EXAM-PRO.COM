<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MDCAT Enzyme Quiz</title>
  <!-- Google Fonts - Inter for better typography -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- html2pdf.js CDN for PDF generation -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <script>
    // Configure Tailwind CSS to use 'Inter' font and custom colors if needed
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            inter: ['Inter', 'sans-serif'],
          },
          animation: {
            // Custom pulse animation for the timer
            pulse: 'pulse 1.5s infinite',
            // Custom fade-in animation for the container
            fadeIn: 'fadeIn 0.6s ease-out',
          },
          keyframes: {
            pulse: {
              '0%, 100%': { transform: 'scale(1)', opacity: '1' },
              '50%': { transform: 'scale(1.03)', opacity: '0.9' },
            },
            fadeIn: {
              'from': { opacity: '0', transform: 'translateY(20px)' },
              'to': { opacity: '1', transform: 'translateY(0)' },
            },
          },
        }
      }
    }
  </script>
  <style>
    /* Custom styles for animations not directly supported by Tailwind utilities */
    body {
      /* Apply Inter font family */
      font-family: 'Inter', sans-serif;
    }
    /* Styles for the hidden PDF content container to ensure proper rendering */
    #pdf-content {
      width: 210mm; /* A4 width */
      min-height: 297mm; /* A4 height */
      box-sizing: border-box;
      background-color: #ffffff; /* Ensure white background for PDF */
      color: #333; /* Default text color */
      font-family: 'Inter', sans-serif;
      font-size: 10pt; /* Base font size for PDF */
      line-height: 1.5;
      padding: 20mm; /* A4 standard margins */
    }
    #pdf-content h1 {
        font-size: 24pt;
        font-weight: 700;
        color: #004d99;
        text-align: center;
        margin-bottom: 20pt;
        border-bottom: 2px solid #e0f7fa;
        padding-bottom: 10pt;
    }
    #pdf-content h2 {
        font-size: 16pt;
        font-weight: 600;
        color: #0056b3;
        margin-top: 20pt;
        margin-bottom: 10pt;
        border-bottom: 1px solid #c9e9ff;
        padding-bottom: 5pt;
    }
    #pdf-content h3 {
        font-size: 12pt;
        font-weight: 600;
        color: #004d99;
        margin-top: 15pt;
        margin-bottom: 8pt;
    }
    #pdf-content table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 15pt;
    }
    #pdf-content th, #pdf-content td {
        border: 1px solid #e0e0e0;
        padding: 8pt;
        text-align: left;
    }
    #pdf-content th {
        background-color: #e0f7fa;
        font-weight: 700;
        color: #0056b3;
    }
    #pdf-content tr:nth-child(even) {
        background-color: #f9f9f9;
    }
    #pdf-content .question-block {
        margin-bottom: 20pt;
        padding: 15pt;
        border: 1px solid #e0e0e0;
        border-radius: 8pt;
        background-color: #fdfdff;
    }
    #pdf-content .question-text {
        font-weight: 600;
        margin-bottom: 10pt;
        color: #333;
    }
    #pdf-content .options-list {
        list-style: none;
        padding: 0;
        margin-bottom: 10pt;
    }
    #pdf-content .options-list li {
        margin-bottom: 5pt;
    }
    #pdf-content .user-answer, #pdf-content .correct-answer-text {
        font-weight: 600;
    }
    #pdf-content .correct-answer-text {
        color: #28a745;
    }
    #pdf-content .incorrect-answer-text {
        color: #dc3545;
    }
    #pdf-content .explanation-section {
        background-color: #eaf6ff;
        border-left: 5px solid #007bff;
        padding: 12pt;
        margin-top: 15pt;
        border-radius: 4pt;
    }
    #pdf-content .explanation-section p {
        margin: 0;
    }
    #pdf-content .explanation-section strong {
        color: #0056b3;
    }

    /* Loading overlay styles */
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(255, 255, 255, 0.8);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      flex-direction: column;
      font-size: 1.2rem;
      font-weight: bold;
      color: #007bff;
    }
    .loading-spinner {
      border: 4px solid #f3f3f3;
      border-top: 4px solid #007bff;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin-bottom: 10px;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>
<body class="font-inter text-xs bg-gradient-to-br from-blue-50 to-blue-200 p-4 text-gray-800 flex justify-center items-center min-h-screen m-0 box-border">
  <!-- Loading Overlay -->
  <div id="loading-overlay" class="loading-overlay hidden">
    <div class="loading-spinner"></div>
    Generating PDF...
  </div>

  <!-- Quiz Section Container -->
  <div class="container max-w-md w-full bg-white p-4 rounded-xl shadow-lg animate-fadeIn border border-gray-200" id="quiz-section">
    <div class="section-title font-bold mb-4 text-sm text-blue-700 text-center border-b-2 border-blue-100 pb-2 drop-shadow-sm">MDCAT Enzyme Quiz</div>
    <div id="timer-wrapper" class="text-sm my-2 text-gray-600 text-center font-semibold">Time Left: <span id="timer" class="text-red-600 font-bold animate-pulse">60s</span></div>
    <div class="progress-bar-container">
      <div class="progress-bar h-full w-0 bg-gradient-to-r from-blue-600 to-blue-400 rounded-lg transition-all duration-400 ease-in-out" id="progressBar"></div>
    </div>
    <div id="question-container"></div>
    <div class="controls flex justify-between mt-4 gap-2">
      <button class="back-btn flex-1 py-2 px-4 rounded-full text-white text-xs font-semibold transition-all duration-300 ease-in-out shadow-md shadow-gray-300 hover:bg-gray-600 hover:-translate-y-0.5 hover:shadow-lg hover:shadow-gray-400 focus:outline-none bg-gray-500" onclick="prevQuestion()">Back</button>
      <button class="next-btn flex-1 py-2 px-4 rounded-full text-white text-xs font-semibold transition-all duration-300 ease-in-out shadow-md shadow-blue-300 hover:bg-blue-700 hover:-translate-y-0.5 hover:shadow-lg hover:shadow-blue-400 focus:outline-none bg-blue-600" onclick="nextQuestion()">Next</button>
      <button class="submit-btn flex-1 py-2 px-4 rounded-full text-white text-xs font-semibold transition-all duration-300 ease-in-out shadow-md shadow-green-300 hover:bg-green-700 hover:-translate-y-0.5 hover:shadow-lg hover:shadow-green-400 focus:outline-none bg-green-600" onclick="submitQuiz()">Submit</button>
    </div>
  </div>

  <!-- Result Section Container -->
  <div class="container max-w-md w-full bg-white p-4 rounded-xl shadow-lg animate-fadeIn border border-gray-200" id="result-section" style="display:none;">
    <div class="section-title font-bold mb-4 text-sm text-blue-700 text-center border-b-2 border-blue-100 pb-2 drop-shadow-sm">Result Summary</div>
    <table class="w-full text-sm border-separate border-spacing-0 mt-4 rounded-lg overflow-hidden shadow-md">
      <thead>
        <tr>
          <th class="p-2.5 border-b border-r border-gray-100 text-left bg-blue-100 font-bold text-blue-700 uppercase tracking-wide">Metric</th>
          <th class="p-2.5 border-b border-r-0 border-gray-100 text-left bg-blue-100 font-bold text-blue-700 uppercase tracking-wide">Value</th>
        </tr>
      </thead>
      <tbody>
        <tr class="even:bg-gray-50">
          <td class="p-2.5 border-b border-r border-gray-100">Attempted Questions</td><td class="p-2.5 border-b border-r-0 border-gray-100 font-bold text-gray-900" id="attempted"></td>
        </tr>
        <tr class="even:bg-gray-50">
          <td class="p-2.5 border-b border-r border-gray-100">Questions Left</td><td class="p-2.5 border-b border-r-0 border-gray-100 font-bold text-gray-900" id="left"></td>
        </tr>
        <tr class="even:bg-gray-50">
          <td class="p-2.5 border-b border-r border-gray-100">Correct Answers</td><td class="p-2.5 border-b border-r-0 border-gray-100 font-bold text-green-600" id="correct"></td>
        </tr>
        <tr class="even:bg-gray-50">
          <td class="p-2.5 border-b border-r border-gray-100">Incorrect Answers</td><td class="p-2.5 border-b border-r-0 border-gray-100 font-bold text-red-600" id="incorrect"></td>
        </tr>
        <tr class="even:bg-gray-50 last:border-b-0">
          <td class="p-2.5 border-r border-gray-100">Overall Percentage</td><td class="p-2.5 border-r-0 border-gray-100 font-bold text-blue-600" id="percentage"></td>
        </tr>
      </tbody>
    </table>
    <div class="flex justify-center gap-2 mt-4">
      <div id="retake">
        <button class="py-2 px-4 rounded-full text-white text-xs font-semibold transition-all duration-300 ease-in-out shadow-md shadow-orange-300 hover:bg-orange-600 hover:-translate-y-0.5 hover:shadow-lg hover:shadow-orange-400 focus:outline-none bg-orange-500" onclick="resetQuiz()">Retake Test</button>
      </div>
      <div id="download-summary">
        <button class="download-btn py-2 px-4 rounded-full text-white text-xs font-semibold transition-all duration-300 ease-in-out shadow-md shadow-blue-300 hover:bg-blue-700 hover:-translate-y-0.5 hover:shadow-lg hover:shadow-blue-400 focus:outline-none bg-blue-600" onclick="downloadQuizSummary()">Download Test Summary (PDF)</button>
      </div>
    </div>
    <div class="flex justify-center gap-2 mt-4">
      <button class="generate-question-btn py-2 px-4 rounded-full text-white text-xs font-semibold transition-all duration-300 ease-in-out shadow-md shadow-purple-300 hover:bg-purple-700 hover:-translate-y-0.5 hover:shadow-lg hover:shadow-purple-400 focus:outline-none bg-purple-600" onclick="generateNewQuestion()">✨ Generate New Question</button>
      <button class="download-question-bank-btn py-2 px-4 rounded-full text-white text-xs font-semibold transition-all duration-300 ease-in-out shadow-md shadow-gray-500 hover:bg-gray-700 hover:-translate-y-0.5 hover:shadow-lg hover:shadow-gray-600 focus:outline-none bg-gray-600" onclick="generateQuizKeyPDF()">Download Question Bank with Key (PDF)</button>
    </div>
  </div>

  <!-- Hidden container for PDF content generation -->
  <div id="pdf-content" class="hidden">
    <!-- Content will be dynamically generated here by JavaScript for PDF export -->
  </div>

  <!-- Generated Question Section Container -->
  <div class="container max-w-md w-full bg-white p-4 rounded-xl shadow-lg animate-fadeIn border border-gray-200 mt-4" id="generated-question-section" style="display:none;">
    <div class="section-title font-bold mb-4 text-sm text-blue-700 text-center border-b-2 border-blue-100 pb-2 drop-shadow-sm">Generated Question</div>
    <div id="generated-question-content">
      <div id="generated-question-text" class="question font-semibold mb-3 text-sm text-blue-800 leading-tight"></div>
      <div id="generated-question-options" class="options flex flex-col gap-2"></div>
      <div id="generated-question-feedback" class="mt-3 text-center text-sm font-semibold"></div>
    </div>
    <div id="generated-question-loading" class="text-center text-gray-500 mt-4 hidden">Generating question...</div>
    <div class="flex justify-center gap-2 mt-4">
      <button id="check-generated-btn" class="py-2 px-4 rounded-full text-white text-xs font-semibold transition-all duration-300 ease-in-out shadow-md shadow-green-300 hover:bg-green-700 hover:-translate-y-0.5 hover:shadow-lg hover:shadow-green-400 focus:outline-none bg-green-600 hidden" onclick="checkGeneratedAnswer()">Check Answer</button>
      <button id="generate-another-btn" class="py-2 px-4 rounded-full text-white text-xs font-semibold transition-all duration-300 ease-in-out shadow-md shadow-purple-300 hover:bg-purple-700 hover:-translate-y-0.5 hover:shadow-lg hover:shadow-purple-400 focus:outline-none bg-purple-600 hidden" onclick="generateNewQuestion()">✨ Generate Another Question</button>
    </div>
  </div>

  <script>
    // Array of quiz questions - populated from the provided MCQs
    const questions = [
      {
        question: "Enzymes are biological catalysts that increase the rate of reactions in living organisms without:",
        options: ["Being consumed", "Releasing energy", "Forming ATP", "Changing the pH"],
        answer: "Being consumed"
      },
      {
        question: "Ribozymes differ from enzymes because they are:",
        options: ["Proteins", "Lipids", "RNA molecules", "DNA fragments"],
        answer: "RNA molecules"
      },
      {
        question: "Enzymes function based on their:",
        options: ["Density", "Color", "Complex structure", "Charge only"],
        answer: "Complex structure"
      },
      {
        question: "The active site of an enzyme is responsible for:",
        options: ["Digesting the enzyme", "Increasing the pH", "Binding the substrate", "Denaturing proteins"],
        answer: "Binding the substrate"
      },
      {
        question: "The specificity of an enzyme is largely determined by:",
        options: ["Number of carbon atoms", "Water presence", "R-groups of amino acids", "Size of the enzyme"],
        answer: "R-groups of amino acids"
      },
      {
        question: "In the lock-and-key hypothesis, the enzyme is imagined as:",
        options: ["A lock", "A door", "A key", "A wall"],
        answer: "A lock"
      },
      {
        question: "In the lock-and-key hypothesis, the substrate is imagined as:",
        options: ["A padlock", "A cell wall", "A lock", "A key"],
        answer: "A key"
      },
      {
        question: "The lock-and-key model assumes the active site:",
        options: ["Changes constantly", "Is a rigid structure", "Binds to all substrates equally", "Requires coenzymes"],
        answer: "Is a rigid structure"
      },
      {
        question: "The induced-fit hypothesis suggests that the enzyme:",
        options: ["Breaks down without substrate", "Changes shape slightly", "Works only in mammals", "Has no active site"],
        answer: "Changes shape slightly"
      },
      {
        question: "The enzyme-substrate complex is formed during:",
        options: ["Dehydration", "Hydrolysis", "Enzyme binding", "Denaturation"],
        answer: "Enzyme binding"
      },
      {
        question: "After releasing the product, the enzyme:",
        options: ["Is broken down", "Changes color", "Remains unchanged", "Stops functioning"],
        answer: "Remains unchanged"
      },
      {
        question: "In the induced-fit model, the enzyme fits the substrate like a:",
        options: ["Spoon in a bowl", "Hand in a glove", "Nail in a wall", "Lock and key"],
        answer: "Hand in a glove"
      },
      {
        question: "The process of converting substrate into product is called:",
        options: ["Hydrolysis", "Catalysis", "Neutralization", "Polymerization"],
        answer: "Catalysis"
      },
      {
        question: "The rate of enzyme action is controlled by:",
        options: ["Number of cells", "Type of sugar", "Shape of active site", "Presence of DNA"],
        answer: "Shape of active site"
      },
      {
        question: "An enzyme-substrate complex increases the likelihood of:",
        options: ["Mutation", "Catalysis", "Death", "Respiration"],
        answer: "Catalysis"
      },
      {
        question: "Enzymes are most active when:",
        options: ["Frozen", "Inactive", "At optimum conditions", "In a vacuum"],
        answer: "At optimum conditions"
      },
      {
        question: "The substrate fits into the enzyme at:",
        options: ["Binding loop", "Reaction corner", "Active site", "Enzyme wall"],
        answer: "Active site"
      },
      {
        question: "The enzyme's ability to bind a specific substrate is called:",
        options: ["Compatibility", "Selectivity", "Specificity", "Polarity"],
        answer: "Specificity"
      },
      {
        question: "The enzyme helps stretch the bond in the substrate to:",
        options: ["Prevent a reaction", "Increase rigidity", "Make it easier to break", "Denature the enzyme"],
        answer: "Make it easier to break"
      },
      {
        question: "The local conditions inside the enzyme can be different from:",
        options: ["Substrate structure", "External pH and ions", "Enzyme sequence", "Temperature"],
        answer: "External pH and ions"
      },
      {
        question: "Enzymes lower the activation energy by:",
        options: ["Removing heat", "Stabilizing the transition state", "Forming glucose", "Increasing water content"],
        answer: "Stabilizing the transition state"
      },
      {
        question: "The energy required to initiate a reaction is called:",
        options: ["Free energy", "Transition energy", "Activation energy", "Reaction heat"],
        answer: "Activation energy"
      },
      {
        question: "A higher activation energy results in:",
        options: ["Rapid reaction", "No reaction", "Slower reaction", "Decreased energy"],
        answer: "Slower reaction"
      },
      {
        question: "Enzymes allow more molecules to:",
        options: ["Denature", "Gain mass", "Overcome the energy barrier", "Become proteins"],
        answer: "Overcome the energy barrier"
      },
      {
        question: "A reaction with lower activation energy:",
        options: ["Happens faster", "Is stopped", "Doesn't occur", "Forms DNA"],
        answer: "Happens faster"
      },
      {
        question: "The difference in energy between reactants and products is:",
        options: ["Activation energy", "Transition state", "ΔG (change in free energy)", "Ionization energy"],
        answer: "ΔG (change in free energy)"
      },
      {
        question: "The enzyme catalase reduces activation energy of H₂O₂ from:",
        options: ["86 kJ/mol to 50 kJ/mol", "100 kJ/mol to 1 kJ/mol", "86 kJ/mol to 1 kJ/mol", "1 kJ/mol to 0.5 kJ/mol"],
        answer: "86 kJ/mol to 1 kJ/mol"
      },
      {
        question: "In the energy graph, enzymes change:",
        options: ["Product energy", "Shape of the graph", "Activation energy", "Substrate concentration"],
        answer: "Activation energy"
      },
      {
        question: "Exothermic reactions release:",
        options: ["Oxygen", "Glucose", "Energy", "Heat only"],
        answer: "Energy"
      },
      {
        question: "The function of catalase is to:",
        options: ["Raise temperature", "Break water", "Reduce H₂O₂", "Form DNA"],
        answer: "Reduce H₂O₂"
      },
      {
        question: "The energy barrier is also called:",
        options: ["Activation energy", "Thermal power", "Substrate charge", "Enzyme heat"],
        answer: "Activation energy"
      },
      {
        question: "Without enzymes, reactions are:",
        options: ["Faster", "Slower", "Impossible", "Endothermic"],
        answer: "Slower"
      },
      {
        question: "Activation energy must be overcome for:",
        options: ["Metabolism", "Transition", "Reaction to occur", "Cell division"],
        answer: "Reaction to occur"
      },
      {
        question: "More molecules can overcome activation energy with:",
        options: ["Light", "Heat", "Enzyme presence", "Water"],
        answer: "Enzyme presence"
      },
      {
        question: "The presence of enzymes converts reactants into:",
        options: ["Fats", "Nucleotides", "Products", "Hormones"],
        answer: "Products"
      },
      {
        question: "T
